<?xml version="1.0" encoding="utf-8"?>

<include>
  <context name="unet">
    <extension name="unloop">
      <condition field="${unroll_loops}" expression="^true$"/>
      <condition field="${sip_looped_call}" expression="^true$">
         <action application="deflect" data="${destination_number}" />
      </condition>
    </extension>

    <!--Opzetten conferentie-->
    <extension name="unet_conferences">
      <condition field="destination_number" expression="^(SUBSUB\d{3})$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>

   <extension name="Call">
     <condition field="destination_number" expression="^(zzz)$">
      <action application="log" data="CONSOLE CALL $1 unet ${sip_from_host} dialedDomain ${sip_to_host}" />
      <action application="bridge" data="sofia/${use_profile}/$1%${sip_to_host}"/>    
 </condition>
   </extension>
    
    <!--Intercom Trainee-Trainee conferentie-->
    <extension name="INTERCOM_CUB_X">
        <condition field="destination_number" expression="^(INTERCOM_CUB_\d{3})$">
          <action application="answer"/>
          <action application="conference" data="$1@default"/>
        </condition>
    </extension>

    <!--Noise-->
    <extension name="I_ESL_SET_NOISE_LEVEL">
      <condition field="destination_number" expression="^(I_ESL_SET_NOISE_LEVEL\d{3})$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>

    <!-- zie: freeswitch.org/confluence/display/freeswitch/outbound+conference+calls 
    Hiermee wordt een conferentie opgezet, die automatisch de leden van de conferentie belt
    hiermee is het opzetten van de conferentie dus een stuk eenvoudiger-->    
    <extension name ="Intercom">
      <condition field="destination_number" expression="^(12345)$">
          <action application="answer" />
 
          <action application="set" data="conference_auto_outcall_timeout=5"/>
          <action application="set" data="conference_auto_outcall_flags=none" />

          <action application="set" data="conference_auto_outcall_caller_id_name=$${effective_caller_id_name}"/>
          <action application="set" data="conference_auto_outcall_caller_id_number=$${effective_caller_id_number}"/>
          <action application="set" data="conference_auto_outcall_profile=default"/>
 
          <action application="conference_set_auto_outcall" data="user/1001@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1010@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1011@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1012@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1013@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1014@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1015@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1016@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1017@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1018@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1019@$${domain}"/>
    
          <action application="conference" data="$1@default" />
      </condition>
    </extension>

   <!-- zie: freeswitch.org/confluence/display/freeswitch/outbound+conference+calls 
    Hiermee wordt een conferentie opgezet, die automatisch de leden van de conferentie belt
    hiermee is het opzetten van de conferentie dus een stuk eenvoudiger-->    
    <extension name ="Class Broadcast Conferentie">
      <!-- 20000 is de ID die we aan de class_broadcast geven -->
      <condition field="destination_number" expression="^(10000)$">
          <action application="answer" />
 
          <action application="set" data="conference_auto_outcall_timeout=50"/>
          <action application="set" data="conference_auto_outcall_flags=none" />

          <action application="set" data="conference_auto_outcall_caller_id_name=$${effective_caller_id_name}"/>
          <action application="set" data="conference_auto_outcall_caller_id_number=$${effective_caller_id_number}"/>
          <action application="set" data="conference_auto_outcall_profile=default"/>
 
          <action application="conference_set_auto_outcall" data="user/1001@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1010@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1011@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1012@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1013@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1014@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1015@$${domain}"/>
          <action application="conference_set_auto_outcall" data="user/1016@$${domain}"/>
 
          <action application="conference" data="$1@default" />
      </condition>
    </extension>

    <!--Monitor trainee-->
    <extension name="MIC_Conference_Pos01">
      <condition field="destination_number" expression="^(MIC_Conference_Pos01\d{3})$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>

    <!--Trainee 01 Left conference -->
    <extension name="LEFTConference_Pos01">
      <condition field="destination_number" expression="^(LEFTConference_Pos01\d{3})$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>

    <!--Trainee 01 Right conference -->
    <extension name="RIGHTConference_Pos01">
      <condition field="destination_number" expression="^(RIGHTConference_Pos01)$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>

  
 
 
    <!--Trainee 03 Right conference -->
    <extension name="RIGHTConference_Pos03">
      <condition field="destination_number" expression="^(RIGHTConference_Pos03\d{3})$">
        <action application="answer"/>
        <action application="conference" data="$1@default"/>
      </condition>
    </extension>


  </context>
</include>
